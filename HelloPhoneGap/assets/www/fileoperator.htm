<!DOCTYPE html>
<html>
<head>
    <title>File System Example</title>
    <script src="jqm/jquery-2.0.3.min.js" type="text/javascript"></script>
    <script src="jqm/jquery.mobile-1.3.2.js" type="text/javascript"></script>
    <script src="cordova.js" type="text/javascript"></script>
    <script type="text/javascript" charset="utf-8">
        var rootPath;
        $(function () {
            document.addEventListener("deviceready", onDeviceReady, false);
            $("#getdic").bind("tap", function () {
                var fullepTH = rootPath + "/developtemp";
                alert(fullepTH);
                var parentEntry = new DirectoryEntry({ fullPath: fullepTH });
                alert(parentEntry.name) ;
                var directoryReader = parentEntry.createReader();
                //读取所有目录
                // 获取目录中的所有条目
                directoryReader.readEntries(function (entries) {
                    var i;
                    var html = "";
                    for (i = 0; i < entries.length; i++) {
                        html += "<li>" + entries[i].fullPath + "</li>";
                    }
                    $("#disks").html(html);
                }, function (error) {
                    alert("Failed to list directory contents:" + error.code);
                });
                //                window.resolveLocalFileSystemURI(rootPath + "/developtemp", function (entries) {
                //                    alert(1);
                //                    var i;
                //                    var html = "";
                //                    for (i = 0; i < entries.length; i++) {
                //                        alert(2);
                //                        html += "<li>" + entries[i].fullPath + "</li>";
                //                    }
                //                    $("#disks").html(html);
                //                }, function (evt) {
                //                    alert(1);
                //                });

            });
        });
        // 等待加载PhoneGap

      
        // 加载文件系统
        function onDeviceReady() {
            window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, onFileSystemSuccess, fail);
        }

        function onFileSystemSuccess(fileSystem) {
            //读取跟目录
            var root = fileSystem.root;
            rootPath = root.fullPath;
            var directoryReader = root.createReader();
            //读取所有目录
            // 获取目录中的所有条目
            directoryReader.readEntries(function (entries) {
                var i;
                var html = "";
                for (i = 0; i < entries.length; i++) {
                    html += "<li>" + entries[i].fullPath + "</li>";
                }
                $("#disks").html(html);
            }, function (error) {
                alert("Failed to list directory contents:" + error.code);
            });
        }


       


        function fail(evt) {
            $("#sfs").append(evt.target.error.code);
        }

    </script>
</head>
<body>
    <input type="button" value="获取某个目录下的详情" id="getdic" />
    <ul id="disks">
    </ul>
</body>
</html>
